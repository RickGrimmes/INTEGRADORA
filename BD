CREATE DATABASE TBC;

use TBC;


CREATE TABLE USUARIO
(
ID_US INT PRIMARY KEY AUTO_INCREMENT,
NOMBRES NCHAR(40) NOT NULL,
APELLIDOS NCHAR(40) NOT NULL,
CORREO NVARCHAR(40) UNIQUE NOT NULL,
CONTRASENA NVARCHAR(20) NOT NULL,
TELEFONO INT NOT NULL,
NIVEL_USUARIO INT NOT NULL
);

CREATE TABLE PLAN
(
ID INT PRIMARY KEY AUTO_INCREMENT,
DURACION NCHAR(30),
PRECIO DECIMAL(19,4) NULL,
DESCUENTO DECIMAL
);

CREATE table INSCRIPCION_GYM
(
REG_INSC INT PRIMARY KEY AUTO_INCREMENT,
FECHA_REG DATE,
FECHA_TER DATE,
ID_CLIENTE INT, FOREIGN KEY (ID_CLIENTE) REFERENCES USUARIO(ID_US),
ID_EMPLEADO INT, FOREIGN KEY (ID_EMPLEADO) REFERENCES USUARIO(ID_US),
PIN INT
);


CREATE TABLE CATEGORIAS
(
ID_CAT INT PRIMARY KEY AUTO_INCREMENT,
NOMBRE NCHAR (40) NOT NULL,
DESCRIPCION TEXT NOT NULL
);

CREATE TABLE PRODUCTOS
(
CVE_P INT PRIMARY KEY AUTO_INCREMENT,
NOMBRE NCHAR(25) NOT NULL,
PRECIO_UNITARIO DECIMAL(6,2) NOT NULL,
DESCUENTO DECIMAL(6,2) NOT NULL,
EXISTENCIA INT NOT NULL,
CATEGORIA INT ,FOREIGN KEY (CATEGORIA) REFERENCES CATEGORIAS(ID_CAT)
);

CREATE TABLE PROVEEDOR
(
ID_PRO INT PRIMARY KEY AUTO_INCREMENT,
NOMBRE NCHAR (40),
DIRECCION NVARCHAR(50),
CORREO NCHAR(40),
TELEFONO INT
);

CREATE TABLE ORDEN_COMPRA
(
ID_COMPRA INT PRIMARY KEY AUTO_INCREMENT,
FECHA DATE,
USUARIO INT,
FOREIGN KEY (USUARIO) REFERENCES USUARIO(ID_US),
PROVEEDOR INT, FOREIGN KEY (PROVEEDOR) REFERENCES PROVEEDOR(ID_PRO)
);

CREATE TABLE ORDEN_VENTA
(
CVE INT PRIMARY KEY AUTO_INCREMENT,
USUARIO INT,
FOREIGN KEY (USUARIO) REFERENCES USUARIO(ID_US),
FECHA_VENTA DATE
);

CREATE TABLE DETALLE_ORDEN_VENTA
(
REG_DOV INT PRIMARY KEY AUTO_INCREMENT,
ORDEN_VENTA INT,
foreign key (ORDEN_VENTA) references ORDEN_VENTA(CVE),
PRODUCTO INT,
foreign key(PRODUCTO) REFERENCES PRODUCTOS(CVE_P),
CANTIDAD INT
);

CREATE TABLE DETALLE_ORDEN_COMPRA
(
ID_DOC INT PRIMARY KEY AUTO_INCREMENT,
ORDEN_COMPRA INT,
foreign key (ORDEN_COMPRA) references ORDEN_COMPRA(ID_COMPRA),
PRODUCTO INT,
foreign key(PRODUCTO) REFERENCES PRODUCTOS(CVE_P),
CANTIDAD INT
);
